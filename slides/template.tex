% include some packages
%\usepackage{kerkis}
\usepackage[T1]{fontenc}
\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{amsmath,mathtools,mathdots}
\usepackage[absolute,overlay]{textpos}
\usepackage{pdfsync}
\usepackage{tikz}
\usepackage{cancel}
\usepackage{nicefrac}
\usepackage{multirow}
\usepackage{algorithmic}
%\usepackage[sc]{mathpazo}
%\usepackage{tgpagella}
%\usepackage[scaled=0.85]{DejaVuSans}
%\usepackage[scaled=0.95]{helvet}
%\usepackage[scaled=0.75]{avant}
%\usepackage[scaled=0.75]{luximono}
\usepackage{cmbright}
\renewcommand{\arraystretch}{1.2} % modify spacing
%\renewcommand{\arraystretch}{0.9}
\usepackage{animate}
\usepackage{calc,amsmath}
\usepackage{booktabs}
\usepackage[sort,compress]{cite}
\usepackage{cleveref}
\usepackage{siunitx}
\usepackage{setspace}
\usepackage{fontawesome}
\usepackage{listings}
\usepackage{matlab-prettifier}

\graphicspath{{figures/}{animations/}{logos/}}

\newif\iffinal
\newif\ifshowfigs
\newif\ifshowanim
\newif\ifappendix

% allows to use same footnote number twice
\crefformat{footnote}{#2\footnotemark[#1]#3}

\sisetup{
round-precision=2,
round-mode=figures,
scientific-notation=true,
output-exponent-marker = \text{E}}

% define the uh colors
\definecolor{primarycolor}   {RGB} {200, 16, 46}
\definecolor{secondarycolor} {RGB} {150, 12, 34}
%\definecolor{secondarycolor} {RGB} {100, 100, 100}
\definecolor{tertiarycolor}  {RGB} {100,  8, 23}

\definecolor{p1color}{RGB} {200, 16, 46} % red
\definecolor{p2color}{RGB} {  0,179,136} % teal
\definecolor{p3color}{RGB} {246,190,  0} % gold
\definecolor{p4color}{RGB} {136,139,141} % cream
\definecolor{p5color}{RGB} {255,249,217} % cream

\definecolor{s1color}{RGB} {150, 12, 34} % brick
\definecolor{s2color}{RGB} {  0,134,108} % green
\definecolor{s3color}{RGB} {216,155,  0} % mustard
\definecolor{s4color}{RGB} { 84, 88, 90} % slate

\definecolor{t1color}{RGB} {100,  8, 23} % chocolate
\definecolor{t2color}{RGB} {  0, 89, 80} % fores
\definecolor{t3color}{RGB} {185,120,  0} % ocher
\definecolor{t4color}{RGB} {  0,  0,  0} % black

\newcommand\ihfig[2]{
\includegraphics[totalheight=#1]{#2}
}

\newcommand\hfig[2]{
\ifshowfigs\includegraphics[totalheight=#1]{#2}\fi
}

\newcommand\iwfig[2]{
\includegraphics[width=#1]{#2}
}

\newcommand\wfig[2]{
\ifshowfigs\includegraphics[width=#1]{#2}\fi
}

% set up theme and add corresponding colors to it
\usetheme[slogan=false]{Boadilla}
\useoutertheme{split}
% \usefonttheme[onlymath]{serif}
% \usefonttheme{serif}
\setbeamercovered{invisible}


% remove stuff
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{footline}{\small\hfill\color{gray}\bf\insertframenumber\hspace{-1cm}\vspace{0.2cm}}
\setbeamertemplate{headline}{}
%\renewcommand\footnotemark{}
\renewcommand\footnoterule{}

\defbeamertemplate{section page}{mysec}[1][]{%
  \begin{centering}
    {\usebeamerfont{section name}\usebeamercolor[fg]{section name}#1}
    \vskip1em\par
    \begin{beamercolorbox}[sep=14pt,center]{part title}
      \usebeamerfont{section title}\insertsection\par
    \end{beamercolorbox}
  \end{centering}
}
\setbeamertemplate{section page}[mysec]


\defbeamertemplate{subsection page}{mysubsec}[1][]{%
  \begin{centering}
    \vskip1em\par
    {\usebeamerfont{subsection name}\usebeamercolor[fg]{subsection name}#1}
    \begin{beamercolorbox}[sep=12pt,center]{subsection title}
      \usebeamerfont{subsection title}\insertsubsection\par
    \end{beamercolorbox}
  \end{centering}
}
\setbeamertemplate{subsection page}[mysubsec]





%\setbeamercolor{normal text}{bg=white,fg=utblack}
\setbeamercolor{normal text}{bg=white,fg=black}
%\setbeamercolor{normal text}{bg=white,fg=black!70}
\setbeamercolor{structure}{fg=primarycolor}
\setbeamercolor{alerted text}{fg=primarycolor}
\setbeamercolor{item projected}{use=item,fg=black,bg=item.fg!35}
\setbeamercolor*{palette primary}{use=structure,fg=white,bg=primarycolor}
\setbeamercolor*{part title}{use=structure,fg=white,bg=primarycolor}
\setbeamercolor*{palette secondary}{use=structure,bg=secondarycolor}
%\setbeamercolor*{palette secondary}{use=structure,bg=black!80}
%\setbeamercolor*{palette tertiary}{use=structure,bg=utsecgreen}
\setbeamercolor*{palette tertiary}{use=structure,bg=tertiarycolor}
%\setbeamercolor*{palette quaternary}{use=structure,fg=white,bg=utsecblue}
%\setbeamercolor*{framesubtitle}{fg=utbrown}
\setbeamercolor*{block title}{parent=structure,fg=white,bg=secondarycolor}
\setbeamercolor*{block body}{fg=black,bg=black!5}
\setbeamercolor*{block body}{fg=black,bg=white}
\setbeamercolor*{block title alerted}{parent=alerted text,bg=black!15}
\setbeamercolor*{block title example}{parent=example text,bg=black!15}
\setbeamercolor*{title}{parent=palette primary}
\setbeamercolor*{local structure}{fg=primarycolor}


% modify layout of footnotes (to make multi line references look nicer)
\makeatletter
\renewcommand<>\beamer@framefootnotetext[1]{
\global\setbox\beamer@footins
\vbox{
\hsize\framewidth
\textwidth\hsize
\columnwidth\hsize
\unvbox\beamer@footins
\reset@font\footnotesize
\@parboxrestore
\protected@edef\@currentlabel
{\csname p@footnote\endcsname\@thefnmark}
\color@begingroup
\uncover#2{\@makefntext{
\rule\z@\footnotesep\ignorespaces\parbox[t]{.9\textwidth}
{\raggedright#1\@finalstrut\strutbox}\vskip1sp}}
\color@endgroup}}
\makeatother

\setbeamertemplate{footnote}{
\parindent0em\noindent
\raggedright
\usebeamercolor{footnote}
\hbox to 0.8em{\hfil\insertfootnotemark}
\insertfootnotetext\par}

% footnote without number
\newcommand\blfootnote[1]{
\begingroup
\renewcommand\thefootnote{}\footnote{#1}
\addtocounter{footnote}{-1}
\endgroup}


\newcommand\fncite[1]{
\begin{flushleft}
\begin{textblock*}{\textwidth}(5mm,82mm)
\footnotesize\it\color{p1color}#1
\end{textblock*}
\end{flushleft}
}

\newcommand\fncomment[1]{
\begin{flushleft}
\begin{textblock*}{\textwidth}(5mm,82mm)
{\footnotesize\color{p1color}#1}
\end{textblock*}
\end{flushleft}
}

% logos
\pgfdeclareimage[height=1.2cm]{utlogobig}{logos/utwordmark2012}
\pgfdeclareimage[height=0.6cm]{utlogo}{logos/utwordmark2012}
\pgfdeclareimage[height=0.7cm]{iceslogo}{logos/ices-secondary-logo}


% font size
%\setbeamerfont{title}{family=\sffamily\bfseries,size=\normalsize}
\setbeamerfont{title}{family=\sffamily\bfseries}
%\setbeamerfont{subtitle}{family=\sffamily,size=\scriptsize}
\setbeamerfont{subtitle}{family=\sffamily,size=\normalsize}
\setbeamerfont{frametitle}{family=\bfseries\sffamily}
\setbeamerfont{frame subtitle}{size=\large}
\setbeamerfont{block title}{family=\sffamily}
\setbeamerfont{section}{family=\sffamily,size=\LARGE}
\setbeamerfont{subsection}{family=\sffamily,size=\LARGE}
\setbeamerfont{author}{family=\sffamily,size=\normalsize}
\setbeamerfont{date}{family=\sffamily,size=\small}
\setbeamerfont{institute}{family=\sffamily\itshape,size=\small}
\renewcommand{\footnotesize}{\tiny}
%\renewcommand{\thefootnote}{\fnsymbol{footnote}}


\setbeamertemplate{title page}{
%\begin{textblock*}{\textwidth}(0.5cm,2.4cm)
%\centering
%{\ifshowanim
%\begin{flushleft}
%\animategraphics[keepaspectratio,height=3.4cm,autoplay,loop]{4}{teaser-sphere-to-bowl}{}{}
%\animategraphics[keepaspectratio,height=3cm,autoplay,loop]{4}{results-nirep-na03-to-na01-h1-ric-animated-teaser}{}{}
%\hfig{2.6cm}{forward-tumor-problem-teaser}
%\animategraphics[keepaspectratio,height=2.3cm,autoplay,loop]{4}{illustration-forward-problem-ut}{}{}
%\end{flushleft}
%\fi}
%\end{textblock*}

\begin{centering}
\begin{beamercolorbox}[sep=1pt,center,rounded=true,shadow=true]{title}
{\usebeamerfont{title}\inserttitle\par}
%\vskip0.3em\par
{\usebeamerfont{subtitle}\insertsubtitle\par}
\end{beamercolorbox}
\end{centering}
%\null\vskip\titleskip\par
\null\vfill
\begin{beamercolorbox}[sep=2pt,left]{institute}
{\usebeamerfont{author}\insertauthor\par}
\vskip0.15cm
{\usebeamerfont{institute}\insertinstitute\par}
\vskip0.15cm
{\usebeamerfont{date}\insertdate\par}
\end{beamercolorbox}}

\let\emph\relax % there's no \RedeclareTextFontCommand
\DeclareTextFontCommand{\emph}{\bfseries\em}

\newcounter{saveenumi}
\newcommand{\seti}{\setcounter{saveenumi}{\value{enumi}}}
\newcommand{\conti}{\setcounter{enumi}{\value{saveenumi}}}
